ext {
  gitCommitHash = getCheckedOutGitCommitHash()
  buildTimestamp = getCalculateBuildTimestamp()
}

def getCheckedOutGitCommitHash() {
  def gitFolder = "${rootDir}/.git/"
  def head = new File(gitFolder + "HEAD").text.split(":")
  def isCommit = head.length == 1
  isCommit ? head[0].trim() : new File(gitFolder + head[1].trim()).text.trim()
}

def getCalculateBuildTimestamp() {
  def buildTime = "<snapshot>"
  def version = rootProject.version
  if (!version.toString().endsWith("SNAPSHOT")) {
    buildTime = new Date().format("yyyy-MM-dd'T'HH:mm:ssZ", TimeZone.getTimeZone("UTC"))
  }
  return buildTime
}
